import requests,json,random,string,time,pyfiglet,termcolor
from bs4 import BeautifulSoup
# -----------------------------------

logo = pyfiglet.figlet_format('AhmedRamzy')
mb = pyfiglet.figlet_format("40 Giga ")
descr = """
Enter Password to make 40 Giga
 By: Ahmed Ramzy
 Facebook: AhmedRamzy.me
 """
print(termcolor.colored(logo, color="red"), termcolor.colored(mb, color="blue"), termcolor.colored(descr, color="green"))
print('=' * 50)
password = input ("password 40 Giga:")
number = input(" [-1-] Enter Number Ana Vodafone: ").strip()
pwd = input (" [-2-] Enter Password Ana Vodafone: ").strip()
with requests.Session() as req:
    # function change the login link every time
    def generationLink(stringLingth):
        latters = string.ascii_lowercase
        return ''.join(random.choice(latters) for i in range(stringLingth))
    urlLoginPage = 'https://web.vodafone.com.eg/auth/realms/vf-realm/protocol/openid-connect/auth?client_id=website&redirect_uri=https%3A%2F%2Fweb.vodafone.com.eg%2Far%2FKClogin&state=286d1217-db14-4846-86c1-9539beea01ed&response_mode=query&response_type=code&scope=openid&nonce={}&kc_locale=en'.format(generationLink(10))
    responsePageLogin = req.get(urlLoginPage)
    soup = BeautifulSoup(responsePageLogin.content, 'html.parser')
    getUrlAction = soup.find('form').get('action')
    # print(getUrlAction)
    # ---------------------------------------------------
    # [1] Send data to the login page
    headerRequest = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
    'Accept-Encoding': 'gzip, deflate, br',
    'Accept-Language': 'en-GB,en;q=0.9,ar;q=0.8,ar-EG;q=0.7,en-US;q=0.6',
    'Connection': 'keep-alive',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Host': 'web.vodafone.com.eg',
    'Origin': 'https://web.vodafone.com.eg',
    'Referer': urlLoginPage,
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36'
    }
    formData = {
    'username':number,
    'password':pwd
    }
    sendUserData = req.post(getUrlAction,headers=headerRequest,data=formData)
    checkRegistry = sendUserData.url
    _checkRegistry = checkRegistry.find('KClogin')
    # [2] Check the registry
    if _checkRegistry != -1:
        code = checkRegistry
        _code = code[code.index('code=') + 5:]
        headerAccessToken = {
        'Accept': '*/*',
        'Accept-Encoding': 'gzip, deflate, br',
        'Accept-Language': 'en-GB,en;q=0.9,ar;q=0.8,ar-EG;q=0.7,en-US;q=0.6',
        'Connection': 'keep-alive',
        'Content-type': 'application/x-www-form-urlencoded',
        'Host': 'web.vodafone.com.eg',
        'Origin': 'https://web.vodafone.com.eg',
        'Referer': 'https://web.vodafone.com.eg/ar/KClogin',
        'Sec-Fetch-Dest': 'empty',
        'Sec-Fetch-Mode': 'cors',
        'Sec-Fetch-Site': 'same-origin',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36'
        }
        formDataAccessToken = {
        'code': _code,
        'grant_type': 'authorization_code',
        'client_id': 'website',
        'redirect_uri': 'https://web.vodafone.com.eg/ar/KClogin'
        }
        sendDataAccessToken = req.post('https://web.vodafone.com.eg/auth/realms/vf-realm/protocol/openid-connect/token',headers=headerAccessToken,data=formDataAccessToken)
        access_token = sendDataAccessToken.json()['access_token']
        # print(access_token)
        #--------------------------------------------------------
        def new2020():
            url = 'https://web.vodafone.com.eg/services/dxl/pom/productOrder'
            header = {
            'Accept': 'application/json',
            'Accept-Language': 'AR',
            'Authorization': f'Bearer {access_token}',
            'Content-Type': 'application/json',
            'msisdn': number,
            'Referer': 'https://web.vodafone.com.eg/spa/miManagement',
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36'
            }
            pay = {
            "channel":{"name":"MobileApp"},"characteristic":[],
            "orderItem":[{"action":"add","product":{"characteristic":[{"name":"LangId",
            "value":"ar"},{"name":"ExecutionType","value":"Sync"}],"id":"MI_LFC_Upgrade_PayDiff",
            "relatedParty":[{"id":f"{number}","name":"MSISDN","role":"Subscriber"}],
            "@type":"MI"}}],"@type":"MIProfile"
            }
            sendRequest = req.post(url, headers=header,data=json.dumps(pay))
            state = sendRequest.json()['state']
            if state == 'Completed':
                print('-'*50)
                print(" __ MB added successfully. __")
                print('-'*50)
            else:
                print(" __ Error. __")    
        new2020()